<div class="d-flex align-items-center no-gutters signup-wrapper">
  <div class="col-sm-8 col-md-12 col-lg-12 mx-auto">
    <div class="navbar-shadow">
      <div class="card-header text-center">
        <h4 class="card-title">Sign Up</h4>
        <p class="card-subtitle">
        </p>
      </div>

      <div class="card-body signup-card-body flow-hidden">
        <h3 *ngIf="popupData.case == 'student'" class="h3-class margin-btm text-center">Be visible, belong, and be you.</h3>
        <div *ngIf="popupData.case == 'student'">
          <ng-container *ngTemplateOutlet="detailedStudentForm"></ng-container>
        </div>
        <div *ngIf="popupData.case == 'recruiter'">
          <ng-container *ngTemplateOutlet="detailedRecruiterForm"></ng-container>
        </div>
      </div>
      <div class="card-footer text-center text-black-50 h6 text-muted">
        Already signed up?
        <a class="text-black-70 pointer curPoint h6 p-2" style="text-decoration: underline;" (click)="login()">Login</a>
      </div>
    </div>
  </div>
</div>

<ng-template #detailedStudentForm>
  <form [formGroup]="userDetailsForm" novalidate>
    <div class="flip-card animated fadeInUp card min-vertical-h-35 mt-3 w50 mx-auto">
      <div class="flip-card-inner p-2">
        <div id="flip-card-front" class="col-12 px-0">
          <div class="form-group d-block">
            <label class="form-label" for="email">Email address <sup class="text-danger">*</sup></label>
            <div class="input-group input-group-merge">
              <input
                id="email"
                type="email"
                formControlName="email"
                class="form-control form-control-prepended"
                placeholder="Email address you would enter to sign in on TaSA"
                (blur)="checkEmail()"
                [ngClass]="{ 'ng-invalid ng-touched': !isEmailAvailable }"
              />
              <div class="input-group-prepend">
                <div class="input-group-text">
                  <span class="far fa-envelope"></span>
                </div>
              </div>
            </div>
            <small
              [hidden]="userDetailsForm.controls.email.valid || userDetailsForm.controls.email.untouched"
              class="text-danger"
              translate
            >
              Email is required
            </small>
            <small [hidden]="isEmailAvailable" class="text-danger" translate>
              Email Address already exists
            </small>
          </div>
          <div class="form-group d-block">
            <label class="form-label" for="password">Password <sup class="text-danger">*</sup></label>
            <div class="input-group input-group-merge">
              <input
                id="password"
                type="password"
                formControlName="password"
                class="form-control form-control-prepended"
                placeholder="Use a stronger password for better protection"
              />
              <div class="input-group-prepend">
                <div class="input-group-text">
                  <span class="fas fa-key"></span>
                </div>
              </div>
            </div>
            <small
              [hidden]="userDetailsForm.controls.password.valid || userDetailsForm.controls.password.untouched"
              class="text-danger"
              translate
            >
              Password is required
            </small>
          </div>
          <div class="form-group d-block">
            <label class="form-label" for="password">Confirm Password <sup class="text-danger">*</sup></label>
            <div class="input-group input-group-merge">
              <input
                id="confirmPassword"
                type="password"
                formControlName="confirmPassword"
                class="form-control form-control-prepended"
                placeholder="Enter your password again, just to be sure"
              />
              <div class="input-group-prepend">
                <div class="input-group-text">
                  <span class="fas fa-key"></span>
                </div>
              </div>
            </div>
            <small
              *ngIf="
                !userDetailsForm.controls.confirmPassword.untouched &&
                userDetailsForm.controls.confirmPassword.errors?.required
              "
              class="text-danger"
              translate
            >
              Confirm Password is required
            </small>
            <small *ngIf="userDetailsForm.controls.confirmPassword.errors?.mustMatch" class="text-danger" translate>
              Confirm Password must match
            </small>
          </div>
        </div>
        <div id="flip-card-back" class="">
          <h6 class="text-center">Before you proceed...</h6>
          <div class="form-group pt-2">
            <label class="form-label" for="name">First Name <sup class="text-danger">*</sup></label>
            <div class="input-group input-group-merge">
              <input
                id="name"
                type="text"
                formControlName="firstName"
                class="form-control form-control-prepended"
                placeholder="Enter your first name"
              />
              <div class="input-group-prepend">
                <div class="input-group-text">
                  <span class="far fa-user"></span>
                </div>
              </div>
            </div>
            <small
              [hidden]="userDetailsForm.controls.firstName.valid || userDetailsForm.controls.firstName.untouched || !userDetailsForm.controls.firstName.errors.required"
              class="text-danger"
              translate
            >
              First Name is required
            </small>
          </div>
          <div class="form-group">
            <label class="form-label" for="name">Last Name <sup class="text-danger">*</sup></label>
            <div class="input-group input-group-merge">
              <input
                id="name"
                type="text"
                formControlName="lastName"
                class="form-control form-control-prepended"
                placeholder="Enter your last name"
              />
              <div class="input-group-prepend">
                <div class="input-group-text">
                  <span class="far fa-user"></span>
                </div>
              </div>
            </div>
            <small
              [hidden]="userDetailsForm.controls.lastName.valid || userDetailsForm.controls.lastName.untouched || !userDetailsForm.controls.lastName.errors.required"
              class="text-danger"
              translate
            >
              Last Name is required
            </small>
          </div>
        </div>
      </div>
    </div>
      <div class="mt-3 text-center">
        <button 
          mat-flat-button color="primary" *ngIf="!show" 
          [disabled]="getForm().confirmPassword.status != 'VALID' || getForm().password.status != 'VALID' || getForm().email.status != 'VALID'" 
          (click)="flipOnClick('flip')" 
          class="rounded-pill ml-2 w30">
          Sign Up For Free
        </button>
        <button mat-flat-button 
          color="primary" 
          *ngIf="show"
          [disabled]="getForm().firstName.status != 'VALID' || getForm().lastName.status != 'VALID'" 
          (click)="flipOnClick('submit')" 
          class="rounded-pill ml-2 w30">
          Alright! Let's Go!
        </button>
      </div>
  </form>  
 
</ng-template>

<ng-template #detailedRecruiterForm>
  <form [formGroup]="userDetailsForm" novalidate>
    <div class="flip-card animated fadeInUp card min-vertical-h-35 mt-3 w50 mx-auto">
      <div class="flip-card-inner p-2">
        <div id="flip-card-front" class="col-12 px-0">
          <div class="form-group">
            <label class="form-label" for="email">Email address <sup class="text-danger">*</sup></label>
            <div class="input-group input-group-merge">
              <input
                id="email"
                type="email"
                formControlName="email"
                class="form-control form-control-prepended"
                placeholder="Your email address"
                (blur)="checkEmail()"
                [ngClass]="{ 'ng-invalid ng-touched': !isEmailAvailable }"
              />
              <div class="input-group-prepend">
                <div class="input-group-text">
                  <span class="far fa-envelope"></span>
                </div>
              </div>
            </div>
            <small
              [hidden]="userDetailsForm.controls.email.valid || userDetailsForm.controls.email.untouched"
              class="text-danger"
              translate
            >
              Email is required
            </small>
            <small [hidden]="isEmailAvailable" class="text-danger" translate>
              Email Address already exists
            </small>
          </div>
          <div class="form-group">
            <label class="form-label" for="password">Password <sup class="text-danger">*</sup></label>
            <div class="input-group input-group-merge">
              <input
                id="password"
                type="password"
                formControlName="password"
                class="form-control form-control-prepended"
                placeholder="Choose a password"
              />
              <div class="input-group-prepend">
                <div class="input-group-text">
                  <span class="fas fa-key"></span>
                </div>
              </div>
            </div>
            <small
              [hidden]="userDetailsForm.controls.password.valid || userDetailsForm.controls.password.untouched"
              class="text-danger"
              translate
            >
              Password is required
            </small>
          </div>
          <div class="form-group">
            <label class="form-label" for="password">Confirm Password <sup class="text-danger">*</sup></label>
            <div class="input-group input-group-merge">
              <input
                id="confirmPassword"
                type="password"
                formControlName="confirmPassword"
                class="form-control form-control-prepended"
                placeholder="Type password"
              />
              <div class="input-group-prepend">
                <div class="input-group-text">
                  <span class="fas fa-key"></span>
                </div>
              </div>
            </div>
            <small
              *ngIf="
                !userDetailsForm.controls.confirmPassword.untouched &&
                userDetailsForm.controls.confirmPassword.errors?.required
              "
              class="text-danger"
              translate
            >
              Confirm Password is required
            </small>
            <small *ngIf="userDetailsForm.controls.confirmPassword.errors?.mustMatch" class="text-danger" translate>
              Confirm Password must match
            </small>
          </div>
        </div>
        <div id="flip-card-back" class="">
          <h6 class="text-center">Before you proceed...</h6>
          <div class="form-group">
            <label class="form-label" for="name">First Name <sup class="text-danger">*</sup></label>
            <div class="input-group input-group-merge">
              <input
                id="name"
                type="text"
                formControlName="firstName"
                class="form-control form-control-prepended"
                placeholder="Your first name"
              />
              <div class="input-group-prepend">
                <div class="input-group-text">
                  <span class="far fa-user"></span>
                </div>
              </div>
            </div>
            <small
              [hidden]="userDetailsForm.controls.firstName.valid || userDetailsForm.controls.firstName.untouched"
              class="text-danger"
              translate
            >
              First Name is required
            </small>
          </div>
          <div class="form-group">
            <label class="form-label" for="name">Last Name <sup class="text-danger">*</sup></label>
            <div class="input-group input-group-merge">
              <input
                id="name"
                type="text"
                formControlName="lastName"
                class="form-control form-control-prepended"
                placeholder="Your last name"
              />
              <div class="input-group-prepend">
                <div class="input-group-text">
                  <span class="far fa-user"></span>
                </div>
              </div>
            </div>
            <small
              [hidden]="userDetailsForm.controls.lastName.valid || userDetailsForm.controls.lastName.untouched"
              class="text-danger"
              translate
            >
              Last Name is required
            </small>
          </div>
          <div class="form-group">
            <label class="form-label" for="name"
              >Organization Name <sup class="text-danger">*</sup>&nbsp;&nbsp;<i
                class="underline curPoint text-primary"
                (click)="createOrganization()"
                >Add Organization</i
              ></label
            >
            <div class="input-group input-group-merge">
              <mat-select
                formControlName="organizationName"
                placeholder="Your Organization"
                required
                class="form-control form-control-prepended"
              >
                <mat-option *ngFor="let item of organisationList" (click)="setOrgId(item)" [value]="item.orgName">
                  {{ item.orgName }}
                </mat-option>
              </mat-select>
              <!-- <input
                  id="name"
                  type="text"
                  formControlName="organizationName"
                  class="form-control form-control-prepended"
                  placeholder="Your organization name"
                /> -->
              <div class="input-group-prepend">
                <div class="input-group-text">
                  <span class="fas fa-university"></span>
                </div>
              </div>
            </div>
            <small
              [hidden]="
                userDetailsForm.controls.organizationName.valid || userDetailsForm.controls.organizationName.untouched
              "
              class="text-danger"
              translate
            >
              Organization Name is required
            </small>
          </div>
        </div>
      </div>
    </div>
    <div class="mt-3 text-center">
      <button 
        mat-flat-button color="primary" *ngIf="!show" 
        [disabled]="getForm().confirmPassword.status != 'VALID' || getForm().password.status != 'VALID' || getForm().email.status != 'VALID'" 
        (click)="flipOnClick('flip')" 
        class="rounded-pill ml-2 w30 btn-height">
        Sign Up For Free
      </button>
      <button mat-flat-button 
        color="primary" 
        *ngIf="show" 
        (click)="flipOnClick('submit')" 
        class="rounded-pill ml-2 w30 btn-height">
        Sign Up
      </button>
    </div>
  </form> 
</ng-template>

<div class="signup-modal">
  <div id="myModal" class="modal" [ngClass]="{ 'd-block': doc != '' }">
    <div class="modal-content">
      <span class="close curPoint" (click)="doc = ''">&times;</span>
      <ngx-doc-viewer [url]="doc" viewer="pdf" style="width: 100%; height: 100%;"></ngx-doc-viewer>
    </div>
  </div>
</div>
